### 移动平台坐标系的命名规范与语义定义（基于ROS的REP 105）

### 摘要
本文档（REP 105）由Wim Meeussen编写，旨在为移动平台在ROS（机器人操作系统）中使用的坐标系提供命名规范和语义定义。通过统一的坐标系规范，促进驱动程序、模型和库的集成与重用，提升软件组件的兼容性和可扩展性。

### 动机
在机器人开发中，驱动程序、模型和库的开发者需要共享的坐标系规范，以便更好地集成和重用软件组件。统一的坐标系规范为移动基座的新定位组件提供了必要的框架，也使得不同移动基座之间的软件兼容性得以提升。例如，本REP规定了编写新定位组件所需的坐标系，并定义了用于引用机器人移动基座的坐标系。

### 规范

#### 坐标系定义
1. **base_link**
   - 固定在移动机器人基座上的刚性坐标系。
   - 其位置和方向可以任意定义，每种硬件平台的base_link位置和方向可能不同。
   - 参考了REP 103中对坐标系方向的偏好规定。

2. **odom**
   - 世界固定坐标系，表示机器人的里程计位置。
   - 机器人在odom坐标系中的位置可能随时间漂移，但其变化是连续的，没有突变。
   - 通常由里程计源（如轮式里程计、视觉里程计或惯性测量单元）计算得出。
   - 适合作为短期的局部参考，但不适合作为长期的全局参考。

3. **map**
   - 世界固定坐标系，Z轴指向上方。
   - 机器人在map坐标系中的位置应长期稳定，不显著漂移。
   - 由定位组件基于传感器观测不断重新计算，以消除漂移，但可能引起位置的离散跳变。
   - 适合作为长期的全局参考，但不适合作为局部感知和行动的参考。

4. **earth**
   - 基于地球中心地固定（ECEF）的坐标系。
   - 设计用于多个地图框架下多机器人系统的交互。
   - 如果使用多个地图，map、odom和base_link需要为每个机器人定制。

#### 坐标系关系
采用树状结构连接所有坐标系，每个坐标系只有一个父坐标系。具体关系如下：
- map 是 odom 的父坐标系
- odom 是 base_link 的父坐标系

#### 额外中间坐标系
允许在基本拓扑结构中插入额外的坐标系，以提供更多功能。例如，为飞行器添加pressure_altitude坐标系，可以在odom和map之间插入，以支持压力高度的估计。

#### 多机器人示例
展示了使用ECEF的多机器人tf图，每个机器人有自己的odom、base_link和map坐标系，同时共享earth坐标系。

#### 坐标系权威性
- odom到base_link的变换由里程计源计算并广播。
- map到odom的变换由定位组件计算，定位组件基于odom到base_link的变换来计算。
- earth到map的变换通常由静态变换发布，或者由全局定位估计动态计算。

#### 地图间转换
当机器人移动到需要切换地图的位置时，定位组件需重新挂载odom坐标系，以适应新的地图。这确保了odom坐标系的连续性和一致性。

#### odom坐标系的一致性
在地图转换过程中，odom坐标系不应受到影响。应根据里程计质量调整数据保留策略，以防止数据因漂移而失效。同时，当机器人移动距离过长导致浮点精度问题时，可能需要系统性地重置odom坐标系的原点。

#### 异常情况
尽管本文档提出了广泛适用的坐标系规范，但由于机器人软件应用的广泛性，某些情况下可能需要不同的坐标系规范。此时，需提供充分的理由并进行详细的文档说明。

### 结论
通过规范移动平台在ROS中的坐标系命名和语义定义，本文档（REP 105）为机器人软件组件的集成与重用提供了统一的基础。这不仅提升了软件兼容性，还为多机器人系统和复杂环境下的定位与导航提供了清晰的框架。