# 串口命令

## 滑台

在这段代码中，实现了一个通过串口控制电机移动的程序。以下是归纳的串口命令及其功能：

1. **move X Y speed mode**：
   - 功能：以指定的终点坐标X、终点坐标Y、速度和模式开始运动。
   - 参数：
     - X：终点坐标X。
     - Y：终点坐标Y。
     - speed：移动速度。
     - mode：运动模式。

2. **pos**：
   - 功能：报告当前电机的位置。

3. **reset**：
   - 功能：重置电机位置和状态。

4. **x[data]**：
   - 功能：设置终点坐标X。
   - 参数：data - 新的X坐标值。

5. **y[data]**：
   - 功能：设置终点坐标Y。
   - 参数：data - 新的Y坐标值。

6. **s[data]**：
   - 功能：设置移动速度。
   - 参数：data - 新的速度值。

7. **m[data]**：
   - 功能：设置运动模式。
   - 参数：data - 新的模式值。

8. **<Enter键>**：
   - 功能：重复最后一次动作。

9. **< ? >**：
   - 功能：显示帮助菜单，列出所有可用命令。

代码中还包含对应于这些命令的功能实现，如解析命令参数、执行电机移动、更新状态和显示相关信息。此外，还有对应于开发板按键的中断处理函数，用于急停电机。

## 履带车

根据您提供的代码，要发送的速度指令主要在 `writeSpeed` 函数中生成和发送。以下是归纳的速度指令的详细内容和格式：

1. **数据包格式**:
   - 数据包由8个字节组成，具体为 `{header, StopFlag, rightVelHigh, rightVelLow, leftVelHigh, leftVelLow, checksum, ender}`。

2. **包头（header）**:
   - 固定值，用于标识数据包的开始，例如 `0xAA`。

3. **停止标志（StopFlag）**:
   - 用于控制机器人的停止或运行。例如，`0x01` 表示运行，其他值可能表示停止。

4. **右轮速度（rightVelSet）**:
   - `rightVelSet` 是一个共用体，包含两个字节，分别为高位和低位。
   - 计算方法依赖于线速度（`RobotV`）和角速度（`YawRate`）。

5. **左轮速度（leftVelSet）**:
   - `leftVelSet` 也是一个共用体，包含两个字节，分别为高位和低位。
   - 计算方法同右轮。

6. **校验位（checksum）**:
   - 通过对前面6个字节（包括header和StopFlag）的值进行加法求和并取低8位得到。

7. **包尾（ender）**:
   - 固定值，用于标识数据包的结束，例如 `0x0D`。

例如，发送速度指令时，首先根据机器人的线速度和角速度计算左右轮的速度，然后将这些值以及`StopFlag`打包成上述格式的数据包，最后通过串口发送这个数据包到下位机。这个过程允许通过调整 `RobotV` 和 `YawRate` 的值来控制机器人的速度和转向。